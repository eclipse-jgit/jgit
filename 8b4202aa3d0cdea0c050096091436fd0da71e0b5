{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "5aa3f45c_9e595cf0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1021966
      },
      "writtenOn": "2024-04-18T11:18:03Z",
      "side": 1,
      "message": "Somehow this doesn\u0027t feel right. I don\u0027t like the fact that we need to extract the signature twice from the commit or tag just to figure out which verifier to use. Also consider that there may be SSH signatures.\n\nDoing this properly may require rethinking the whole setup.",
      "revId": "8b4202aa3d0cdea0c050096091436fd0da71e0b5",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "923daf0c_2cd9a419",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2024-04-18T14:22:27Z",
      "side": 1,
      "message": "\u003e Somehow this doesn\u0027t feel right. I don\u0027t like the fact that we need to extract the signature twice from the commit or tag just to figure out which verifier to use. Also consider that there may be SSH signatures.\n\nDo you have any pointer to the SSH signatures?\n\n\u003e Doing this properly may require rethinking the whole setup.\n\nCan you elaborate further?",
      "parentUuid": "5aa3f45c_9e595cf0",
      "revId": "8b4202aa3d0cdea0c050096091436fd0da71e0b5",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ab5ed702_2115f7ab",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1000671
      },
      "writtenOn": "2024-04-18T22:42:44Z",
      "side": 1,
      "message": "regarding ssh signing:\nhttps://lore.kernel.org/git/?q\u003d%22ssh+signing%22\u0026o\u003d400\nhttps://github.com/git/git/blob/master/Documentation/config/gpg.txt\nhttps://blog.gitbutler.com/signing-commits-in-git-explained/\nhttps://blog.dbrgn.ch/2021/11/16/git-ssh-signatures/",
      "parentUuid": "923daf0c_2cd9a419",
      "revId": "8b4202aa3d0cdea0c050096091436fd0da71e0b5",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a1d23fab_bc3a68b4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1021966
      },
      "writtenOn": "2024-04-22T08:00:37Z",
      "side": 1,
      "message": "\u003e Can you elaborate further?\n\nI think the service is at wrong level. I already factored out extracting the signature from a commit or a tag to an abstract super class. That was probably not correct; it should have been a separate stand-alone class. So code would always call the single verifier. That one would then, after having extracted the signature, examine the \"-----BEGIN...\" line to figure out what kind of signature it is, and then try to find the right service able to verify this raw signature.\n\nThe difficult thing would be to pull off such a refactoring without breaking API.\n\nBasically the service should only have the `verify(GpgConfig, byte[], byte[])` method. And _always_ pass through the `GpgConfig`. It is needed if one wants to provide alternate service implementations. EGit does so: it provides implementations that use the external gpg executable instead of Bouncy Castle. The Bouncy Castle implementation is not always able to find the public keys. For instance when GPG uses the keyboxd daemon (as Gpg4Win does since version 4.2.0), it stores public keys in an sqlite database.\n\nI don\u0027t remember off-hand under what header SSH signatures are stored in commits; if it\u0027s still \"gpgsig\" then we should be fine for commits. For tags the signature is just tacked onto the end of the message, so extracting it there would need to be able to handle different \"-----BEGIN...\" lines. Currently `RevTag` hard-codes \"-----BEGIN PGP SIGNATURE\".",
      "parentUuid": "ab5ed702_2115f7ab",
      "revId": "8b4202aa3d0cdea0c050096091436fd0da71e0b5",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "15fa9b85_c2d4da53",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2024-04-23T08:49:46Z",
      "side": 1,
      "message": "I see, so you would suggest to add the X509 (and all other signatures\u0027 logic) into the same GPG signature verifier, even though they have nothing to do with GPG?",
      "parentUuid": "a1d23fab_bc3a68b4",
      "revId": "8b4202aa3d0cdea0c050096091436fd0da71e0b5",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "340bd457_27c83be5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2024-04-23T13:42:31Z",
      "side": 1,
      "message": "I believe I know what you mean: instead of doing the redirection to the service at verification factory level, we should have a single verifier which should have the common role of extracting the payload and signature.\n\nThat single verifier is then responsible for looking for the right _service_ to decode the signature, using a service discovery pattern based on the signature prefix.\n\n@twolf@apache.org Should we then refactor the change in that direction? Or would you suggest to make a different one, or possibly more than one?",
      "parentUuid": "15fa9b85_c2d4da53",
      "revId": "8b4202aa3d0cdea0c050096091436fd0da71e0b5",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e3f04690_3b678d08",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1021966
      },
      "writtenOn": "2024-04-23T15:28:31Z",
      "side": 1,
      "message": "Yes, that\u0027s the idea. (Just an idea for now. I\u0027m only thinking about this in the abstract; hope it works out well when it\u0027s actually coded.)\n\nThe naming is all a bit unfortunate; it looks like we\u0027re going the same route as C git did, and end up with same naming mess: start with GPG signing/verification, later add other stuff, and be stuck with \"Gpg...\" names for non-Gpg things... even the git configs are still named \"gpg.*\", even for x509 or ssh. And so are our bundle name and package names now.\n\nIf the original contribution of this fragment had been named org.eclipse.jgit.signing.bc it would all be much clearer. But that ship has sailed; changing bundle names is always a hassle to ensure bundle updates in OSGi work as expected and not to be done in a minor release.",
      "parentUuid": "340bd457_27c83be5",
      "revId": "8b4202aa3d0cdea0c050096091436fd0da71e0b5",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b37a887c_5a477431",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 9
      },
      "lineNbr": 0,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2024-04-25T23:12:35Z",
      "side": 1,
      "message": "Done with Ib635baae9",
      "parentUuid": "e3f04690_3b678d08",
      "revId": "8b4202aa3d0cdea0c050096091436fd0da71e0b5",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}
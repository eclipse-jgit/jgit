{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "33410276_c956310d",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/internal/storage/file/RefDirectory.java",
        "patchSetId": 1
      },
      "lineNbr": 481,
      "author": {
        "id": 1038403
      },
      "writtenOn": "2025-07-10T17:32:50Z",
      "side": 0,
      "message": "On the surface, this whole loop seems pointless instead of just doing the isDirectory() test in the if() on line 489. Perhaps this is to affect the sorting somehow by adding the \"/\" at the end, but I can\u0027t see how? \n\nOn another note, you would hope that java would have an even faster way to lookup whether something is a directory at the same time as getting the directory listing, avoiding another potential round trip here also?",
      "revId": "e328d203f20b8cd0a9b55678bfe3678ffd5d8179",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "de8441d1_922f3c38",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/internal/storage/file/RefDirectory.java",
        "patchSetId": 1
      },
      "lineNbr": 481,
      "author": {
        "id": 1000671
      },
      "writtenOn": "2025-07-10T18:49:39Z",
      "side": 0,
      "message": "I would try to replace our own tree traversal which uses `scanTree()` recursively with `java.nio.file.Files.walkFileTree()` using a `FileVisitor` assuming that `java.nio.file` is more optimized than the old `java.io.File` implementations.\nThe visitor can parse the files representing loose refs (that\u0027s done in `scanOne()` in the current implementation).",
      "parentUuid": "33410276_c956310d",
      "revId": "e328d203f20b8cd0a9b55678bfe3678ffd5d8179",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8ac5f2fe_46ee8737",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/internal/storage/file/RefDirectory.java",
        "patchSetId": 1
      },
      "lineNbr": 481,
      "author": {
        "id": 1038403
      },
      "writtenOn": "2025-07-10T19:12:22Z",
      "side": 0,
      "message": "Yeah, I was thinking something similar, but to be honest, there is other fishy stuff I don\u0027t quite understand yet. If I write a tiny program to scan the same directory the way it is being done in here, it only takes about 122ms, yet an ls-remote seems to spend almost 6s in this section and there are only 3 loose refs. So something is weird, I am probably doing a something wrong, but I really think we might have a lot to improve here.\n\nAny thoughts about why there are two loops instead of one, there just seems like a ton of wordy code in here that can be done with only about 5 lines?",
      "parentUuid": "de8441d1_922f3c38",
      "revId": "e328d203f20b8cd0a9b55678bfe3678ffd5d8179",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "524fda50_ef4472f3",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/internal/storage/file/RefDirectory.java",
        "patchSetId": 1
      },
      "lineNbr": 481,
      "author": {
        "id": 1000671
      },
      "writtenOn": "2025-07-10T19:19:54Z",
      "side": 0,
      "message": "Most of this code was [written by Shawn 15 years ago using Java 5](https://eclipse.gerrithub.io/c/eclipse-jgit/jgit/+/194). I guess it\u0027s time to modernise it.",
      "parentUuid": "8ac5f2fe_46ee8737",
      "revId": "e328d203f20b8cd0a9b55678bfe3678ffd5d8179",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}
{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "108a4f9b_f631e60e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 15,
      "author": {
        "id": 1541
      },
      "writtenOn": "2023-10-26T20:37:45Z",
      "side": 1,
      "message": "@Matthias, I\u0027d appreciate your thoughts on this TODO and what you think the direction should be. I\u0027m leaning towards having a policy switch in RefDirectory to refresh loose ref dirs (off by default), something like `trustLooseRefStat.AFTER_OPEN`, and then in a follow-up change, add the functionality for SnapshottingRefDirectory to remember which loose ref dirs have been refreshed and not refresh them again unless the snapshot becomes invalid.",
      "revId": "c194114aaffc54653364e991e818570610b9411c",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "55c8289f_982cd01f",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 15,
      "author": {
        "id": 1022030
      },
      "writtenOn": "2024-02-28T21:57:09Z",
      "side": 1,
      "message": "This is done now in the parent change.",
      "parentUuid": "108a4f9b_f631e60e",
      "revId": "c194114aaffc54653364e991e818570610b9411c",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "07c6c449_82104c96",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/internal/storage/file/SnapshottingRefDirectory.java",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 5082
      },
      "writtenOn": "2023-10-29T20:50:50Z",
      "side": 1,
      "message": "A write from this snapshot object could happen by another three another could happen after the refresh and get missed by the next reader because this will mark it refreshed. Perhaps instead of clearing the set, it makes more sense to make the set volatile and to create a new one, so that you could grab a reference to the existing set before the loop above and only add to it. Using that approach, if the set were replaced in the meantime with a new blank one, you wouldn\u0027t be adding to it!",
      "revId": "c194114aaffc54653364e991e818570610b9411c",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a01ed55d_36629638",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/internal/storage/file/SnapshottingRefDirectory.java",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1541
      },
      "writtenOn": "2023-10-30T02:47:02Z",
      "side": 1,
      "message": "Yeah, that or a compareAndSet like what\u0027s used in other parts of the code base. I\u0027ll take a look at it, thanks.",
      "parentUuid": "07c6c449_82104c96",
      "revId": "c194114aaffc54653364e991e818570610b9411c",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1d3d59a7_ee5f4c3d",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/internal/storage/file/SnapshottingRefDirectory.java",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1022030
      },
      "writtenOn": "2024-02-27T20:43:52Z",
      "side": 1,
      "message": "Hmm, thinking on this more. Even if the set were cleared, we did *just* refresh this dir, so I don\u0027t think it\u0027s a problem to add it to the set.",
      "parentUuid": "a01ed55d_36629638",
      "revId": "c194114aaffc54653364e991e818570610b9411c",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "071a5385_8e6ca785",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/internal/storage/file/SnapshottingRefDirectory.java",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1022030
      },
      "writtenOn": "2024-02-28T21:57:09Z",
      "side": 1,
      "message": "@quic_kaushikl@quicinc.com, @matthias.sohn@sap.com do you have thoughts on if this is an issue or not?",
      "parentUuid": "1d3d59a7_ee5f4c3d",
      "revId": "c194114aaffc54653364e991e818570610b9411c",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fb2c86cf_c2b6a90d",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/internal/storage/file/SnapshottingRefDirectory.java",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1000671
      },
      "writtenOn": "2024-03-03T21:21:30Z",
      "side": 1,
      "message": "I don\u0027t understand what Martin said\n\nIf we consider multiple threads a race is always possible, the cached view of a snapshotted refdirectory can get outdated by another thread any time.",
      "parentUuid": "071a5385_8e6ca785",
      "revId": "c194114aaffc54653364e991e818570610b9411c",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3b1bc46a_e45c6dbf",
        "filename": "org.eclipse.jgit/src/org/eclipse/jgit/internal/storage/file/SnapshottingRefDirectory.java",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1037769
      },
      "writtenOn": "2024-03-06T20:01:37Z",
      "side": 1,
      "message": "\u003e I don\u0027t understand what Martin said\n\u003e \n\u003e If we consider multiple threads a race is always possible, the cached view of a snapshotted refdirectory can get outdated by another thread any time.\n\n+1",
      "parentUuid": "fb2c86cf_c2b6a90d",
      "revId": "c194114aaffc54653364e991e818570610b9411c",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}
{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "c1cd13ae_53cd0655",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 44628
      },
      "writtenOn": "2023-05-22T16:00:42Z",
      "side": 1,
      "message": "\u003e Patch Set 7: Verified-1\n\u003e \n\u003e Build Failed \n\u003e \n\u003e https://ci.eclipse.org/jgit/job/stable/job/jgit.gerrit-pipeline.java11-test/139/ : FAILURE\n\n  [ERROR] Cannot resolve project dependencies:\n  17:47:41  [ERROR]   Software being installed: org.eclipse.jgit.ssh.apache.feature.group 6.6.0.qualifier\n  17:47:41  [ERROR]   Missing requirement: net.i2p.crypto.eddsa 0.3.0 requires \u0027java.package; sun.security.x509 0.0.0\u0027 but it could not be found\n  17:47:41  [ERROR]   Cannot satisfy dependency: org.eclipse.jgit.ssh.apache 6.6.0.202305221538 depends on: java.package; net.i2p.crypto.eddsa [0.3.0,0.4.0)\n  17:47:41  [ERROR]   Cannot satisfy dependency: org.eclipse.jgit.ssh.apache.feature.group 6.6.0.qualifier depends on: org.eclipse.equinox.p2.iu; org.eclipse.jgit.ssh.apache 0.0.0\n  \nHmmm. Pretty bad if that net.i2p library depends on that JDK-internal package. The manifest has\n\n  Import-Package: sun.security.x509;resolution:\u003doptional\n\nIf this package has gone in Java 17, we have a problem. But I did build locally (I think on Java 11) and install into an Eclipse running on Java 17, and I am using ed25519 keys, and I didn\u0027t notice any problems. So it looks as if we need to run the tycho packaging with Java 11. But at the same time we need Java 17 to use tycho 4.0.0. Can we add an --add-opens somewhere?",
      "revId": "587c8e554e62c3c9d0a0696b47e8481eccb34fd5",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a289c81f_a35cd411",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 4
      },
      "writtenOn": "2023-05-22T16:11:14Z",
      "side": 1,
      "message": "Why does a missing optional dependency fail the build ?\nWe can add --add-opens to the compiler and surefire plugin configurations:\nhttps://nipafx.dev/maven-on-java-9/",
      "parentUuid": "c1cd13ae_53cd0655",
      "revId": "587c8e554e62c3c9d0a0696b47e8481eccb34fd5",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b63f41a5_59d1df61",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 4
      },
      "writtenOn": "2023-05-22T21:28:00Z",
      "side": 1,
      "message": "I don\u0027t know how to do this for the eclipse compiler,\nsee https://issues.apache.org/jira/browse/MCOMPILER-123\n\nSetting it via Eclipse \"project properties \u003e Java Build Path \u003e Module Dependencies\" doesn\u0027t work since \"Expose Package\" is disabled on java.base/sun.security.x509",
      "parentUuid": "a289c81f_a35cd411",
      "revId": "587c8e554e62c3c9d0a0696b47e8481eccb34fd5",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "590dc333_58377f47",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 44628
      },
      "writtenOn": "2023-05-22T22:18:05Z",
      "side": 1,
      "message": "It doesn\u0027t fail during compilation. It fails during tycho packaging build when building the org.eclipse.jgit.ssh.apache *feature*. So maybe --add-export or --add-opens was the wrong idea anyway. Looks a bit like a bug in tycho?",
      "parentUuid": "b63f41a5_59d1df61",
      "revId": "587c8e554e62c3c9d0a0696b47e8481eccb34fd5",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ebf93c57_4e29a9c1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 44628
      },
      "writtenOn": "2023-05-23T05:44:35Z",
      "side": 1,
      "message": "I think we should re-build the Orbit bundle for net.i2p.crypto.eddsa. This sun.security.X509 dependency is a test dependency only here: https://github.com/str4d/ed25519-java/blob/7c26a6312c2d2e887210930698706103e0f2da7d/test/net/i2p/crypto/eddsa/EdDSAEngineTest.java#L34\n\nThe maven artifact does not contain the test classes. But its MANIFEST has the import-package (even as mandatory). We should not include this import-package in the MANIFEST generated for the Orbit bundle at all.\n\nHere\u0027s a worst-case solution for getting a release out of the door: for JGit, stick with Java 11 and Tycho 2.7.5 for the release. Yes, the JGit p2 repo will have unsigned bundles. But everything gets built correctly. The EGit build produces the p2 repo that is used in SimRel, and it contains the JGit bundles as copies and it doesn\u0027t reference the JGit p2 repo, and the EGit build manages to sign everything as needed. Installation into Eclipse is normally from the EGit p2 repo. So for SimRel and Eclipse everything should be fine.",
      "parentUuid": "590dc333_58377f47",
      "revId": "587c8e554e62c3c9d0a0696b47e8481eccb34fd5",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "23ad3c7c_1e9f3e7b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 44628
      },
      "writtenOn": "2023-05-23T17:57:03Z",
      "side": 1,
      "message": "Got it: the problem is in the target platform: commit 7e094c6cf32 imports net.i2p.crypto.eddsa directly from Maven. But that bundle has a broken MANIFEST.MF, in which sun.security.x509 is a _mandatory_ dependency!\n\nSo this must go back to use the Orbit version with the _optional_ dependency (which shouldn\u0027t be there at all, but that can be fixed after the release).\n\nFix in https://git.eclipse.org/r/c/jgit/jgit/+/202026/1 .",
      "parentUuid": "ebf93c57_4e29a9c1",
      "revId": "587c8e554e62c3c9d0a0696b47e8481eccb34fd5",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4bedf880_39c5296f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 4
      },
      "writtenOn": "2023-05-23T23:24:53Z",
      "side": 1,
      "message": "I removed the package import for sun.security.X509 in https://github.com/eclipse/orbit/pull/23",
      "parentUuid": "ebf93c57_4e29a9c1",
      "revId": "587c8e554e62c3c9d0a0696b47e8481eccb34fd5",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c59af5b6_ffbdf854",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 4
      },
      "writtenOn": "2023-05-23T23:27:14Z",
      "side": 1,
      "message": "interestingly the Orbit validation build of this PR fails with\n\n```\nError:  Cannot resolve project dependencies:\nError:    Software being installed: org.eclipse.orbit.releng.recipes.feature.aggregation.feature.group 1.0.0.qualifier\nError:    Missing requirement: net.i2p.crypto.eddsa 0.3.0.v20230523-1123 requires \u0027java.package; sun.security.x509 0.0.0\u0027 but it could not be found\nError:    Cannot satisfy dependency: org.eclipse.orbit.releng.recipes.feature.aggregation.feature.group 1.0.0.qualifier depends on: org.eclipse.equinox.p2.iu; net.i2p.crypto.eddsa [0.3.0,0.3.1)\n```\r\n\nhttps://github.com/eclipse/orbit/actions/runs/5056660109/jobs/9088345142?pr\u003d23",
      "parentUuid": "4bedf880_39c5296f",
      "revId": "587c8e554e62c3c9d0a0696b47e8481eccb34fd5",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "47d782b5_ce996fb9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 4
      },
      "writtenOn": "2023-05-23T23:33:36Z",
      "side": 1,
      "message": "Actually a PR fixing this issue upstream was approved in 2019:\nhttps://github.com/str4d/ed25519-java/pull/78\nbut there is no release including this change.\n\nIt seems this project was abandoned in favour of\nhttps://github.com/cryptography-cafe/ed25519-elisabeth\nsee https://github.com/str4d/ed25519-java/issues/71\n\nJEP 339 added a ed25519 implementation to Java 15, see https://openjdk.org/jeps/339",
      "parentUuid": "c59af5b6_ffbdf854",
      "revId": "587c8e554e62c3c9d0a0696b47e8481eccb34fd5",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "de5a2df8_b9c04aa6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 44628
      },
      "writtenOn": "2023-05-24T05:41:06Z",
      "side": 1,
      "message": "OK, so maybe I was wrong about that sun.security.x509 dependency.\n\nI know. And Bouncy Castle also has ed25519. I wanted to get rid of it in Apache MINA sshd for quite a while already. Have even started with it, but Apache MINA sshd code is a mess, and getting to the point where it could work with any ed25519 implementation is surprisingly hard. net.i2p.crypto.eddsa has also a security bug -- malleable signatures.",
      "parentUuid": "47d782b5_ce996fb9",
      "revId": "587c8e554e62c3c9d0a0696b47e8481eccb34fd5",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "745ef490_98d1011c",
        "filename": "org.eclipse.jgit.packaging/pom.xml",
        "patchSetId": 7
      },
      "lineNbr": 219,
      "author": {
        "id": 44628
      },
      "writtenOn": "2023-05-22T15:47:43Z",
      "side": 1,
      "message": "You probably also don\u0027t want this.",
      "revId": "587c8e554e62c3c9d0a0696b47e8481eccb34fd5",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1f5e8d66_90781953",
        "filename": "org.eclipse.jgit.packaging/pom.xml",
        "patchSetId": 7
      },
      "lineNbr": 219,
      "author": {
        "id": 4
      },
      "writtenOn": "2023-05-22T15:57:39Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "745ef490_98d1011c",
      "revId": "587c8e554e62c3c9d0a0696b47e8481eccb34fd5",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31"
    }
  ]
}